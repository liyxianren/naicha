# 奶茶大作战 - 需求理解确认文档

**致客户：**  
感谢您提供的游戏设计资料。为确保我们准确理解您的需求，我们整理了这份文档，请您审阅确认我们的理解是否正确。确认无误后，我们将开始技术开发工作。

---

## 📋 一、我们对游戏规则的理解

### 游戏背景与目标
- 这是一个商业模拟桌游，玩家扮演奶茶店经营者
- 通过产品研发、定价、营销等决策进行商业竞争
- 游戏分为**线下部分**（实体卡牌、骰子）和**线上部分**（数据计算、报表）
- 最终目标：累计利润最高的玩家获胜

### 游戏核心机制

#### 1. 店铺运营
- **租店**：每回合公布可租店铺，租金随机，多人竞租时价高者得
- **装修**：三种等级
  - 简装（400元）→ 容纳2位员工
  - 精装（800元）→ 容纳3位员工
  - 豪华装（1600元）→ 容纳4位员工

#### 2. 产品研发
7种配方，研发难度和圈粉率不同：

| 产品名称 | 配方 | 研发难度 | 初始圈粉率 | 单杯成本 |
|---------|------|---------|----------|---------|
| 奶茶 | 1牛奶+1茶叶 | 3 | 5% | 10元 |
| 椰奶 | 1牛奶+1水果 | 3 | 5% | 9元 |
| 柠檬茶 | 1茶叶+1水果 | 3 | 5% | 11元 |
| 果汁 | 2水果 | 3 | 5% | 10元 |
| 珍珠奶茶 | 2牛奶+1茶叶+1配料 | 4 | 20% | 16元 |
| 水果奶昔 | 1牛奶+1水果+3配料 | 4 | 20% | 15元 |
| 水果茶 | 3水果+1茶叶+1配料 | 5 | 30% | 23元 |

**研发规则：**
- 投入600元/次，掷骰子点数 > 难度值即成功

**原材料价格（每10份）：**
- 茶叶60元、牛奶40元、水果50元、配料20元
- 批量折扣：每购买50份，价格-10%（可累加，最低至原价50%）
- ⚠️ 保质期仅1回合

#### 3. 定价与营销
- **定价**：10-40元之间，必须是5的倍数
- **广告**：花费800元，掷骰子获得1-6点广告分
- **市场调研**：花费500元，可查看下一回合客流量

#### 4. 人力管理
- 人力市场每回合刷新5位员工（线下抽卡）
- 员工属性：姓名、工资、生产力（生产力在招募后查看）
- 玩家需将员工的总生产力分配到不同产品

#### 5. 客流与销售（核心机制）

**口碑分计算公式：**
```
口碑分 = 广告分 + 圈粉率 × 累计销售杯数
```

**客户类型与购买逻辑：**

| 客户类型 | 购买优先级 | 次要考虑 | 平分规则 |
|---------|----------|---------|---------|
| 高购买力客户 | 口碑分最高 | 价格最低 | 口碑分和价格都相同时平分 |
| 低购买力客户 | 价格最低（口碑>0） | 口碑分最高 | 价格和口碑分都相同时平分 |

**重要规则：生产力优先满足高购买力客户！**

**示例场景验证（请确认是否正确）：**

假设某地块有：
- 20位高购买力客户
- 60位低购买力客户

五家店的产品情况：

| 产品 | 口碑分 | 定价 | 生产力 |
|-----|-------|------|-------|
| A | 50 | 25元 | 10杯 |
| B | 40 | 20元 | 5杯 |
| C | 30 | 15元 | 15杯 |
| D | 30 | 10元 | 20杯 |
| E | 25 | 10元 | 10杯 |

**我们理解的销售结果：**

1. **高购买力客户购买顺序**：
   - 先买A（口碑最高50）→ 10杯卖完
   - 再买B（口碑第二40）→ 5杯卖完
   - 再买D（口碑30，比C便宜）→ 5杯
   - 共计20位客户全部购买

2. **低购买力客户购买顺序**：
   - 先买D（价格最低10元，口碑30>25）→ D剩余15杯（20-5=15）
   - 再买E（价格同为10元，但D已售完）→ 10杯卖完
   - 再买C（价格第二低15元）→ 15杯卖完
   - 剩余20位客户无法购买（B、A价格太贵）

**销售汇总：**
- A：10杯（全给高购买力客户），收入250元
- B：5杯（全给高购买力客户），收入100元
- C：15杯（全给低购买力客户），收入225元
- D：20杯（5杯给高购买力客户+15杯给低购买力客户），收入200元
- E：10杯（全给低购买力客户），收入100元

**请确认：以上理解是否正确？**

---

## 💻 二、线上系统开发内容

根据您提供的架构图，我们将开发三个相互关联的模块：

### 模块1：生产端（玩家操作界面）

这是玩家进行各项决策的主界面，包含以下功能区：

#### 📍 功能区1：开店决策
- 输入本回合租到的店铺租金（线下抽卡获得）
- 选择装修等级（简装/精装/豪华装）
- 系统自动扣除相应费用

#### 📍 功能区2：人力管理
- 根据装修等级显示员工栏位（2/3/4个）
- 显示当前已招募员工列表（姓名、工资、生产力）
- 招募新员工时，录入线下抽到的员工信息
- 如果达到容纳上限，则禁止招募

#### 📍 功能区3：市场决策
- **市场调研按钮**：点击后扣除500元，显示下一回合客流量
- **广告投放按钮**：点击后扣除800元，输入掷骰子得到的广告分（1-6点）

#### 📍 功能区4：研发决策
- 显示7种配方的研发状态（未研发/研发中/已解锁）
- 点击"研发"按钮，扣除600元
- 输入掷骰子结果，判断是否研发成功
- 成功后配方解锁，可以进行生产

#### 📍 功能区5：生产决策（核心功能）
- 显示所有已解锁的配方
- 显示可分配的总生产力（所有员工生产力之和）
- 为每个配方分配生产力（输入框）
- 为每个配方设定定价（10-40元，5的倍数）
- 系统自动计算：
  - 需要采购的原材料数量
  - 原材料成本（含批量折扣）
  - 本次生产总成本

**界面示意（请确认）：**
```
┌──────────────────────────────────────────────────┐
│  可分配总生产力：15 杯                            │
├──────────────────────────────────────────────────┤
│  ✓ 奶茶 (圈粉率5%, 累计销售30杯)                  │
│     ├─ 分配生产力：[__5__] 杯                     │
│     ├─ 定价：[__15__] 元                          │
│     ├─ 原料需求：茶叶5份、牛奶5份                 │
│     └─ 生产成本：50元                             │
├──────────────────────────────────────────────────┤
│  ✓ 珍珠奶茶 (圈粉率20%, 累计销售10杯)             │
│     ├─ 分配生产力：[__10__] 杯                    │
│     ├─ 定价：[__25__] 元                          │
│     ├─ 原料需求：茶叶10份、牛奶20份、配料10份     │
│     └─ 生产成本：160元                            │
├──────────────────────────────────────────────────┤
│  ✗ 水果茶 (未解锁)                                │
│     需要研发                                       │
└──────────────────────────────────────────────────┘
```

---

### 模块2：计算端（后台计算引擎）

这个模块对玩家不可见，负责自动计算游戏核心数据。

#### 🔢 计算功能1：口碑分计算
- 每回合更新每个产品的口碑分
- 公式：`口碑分 = 广告分 + 圈粉率 × 累计销售杯数`
- **注意**：累计销售杯数要累加历史所有回合的销售

#### 🔢 计算功能2：客流分配（核心算法）
- 输入数据：
  - 本回合客流量（高购买力客户数、低购买力客户数）
  - 所有玩家的所有产品（口碑分、定价、生产力）
- 计算过程：
  1. 按高购买力客户购买逻辑排序产品
  2. 依次分配客流，优先满足高购买力客户
  3. 按低购买力客户购买逻辑排序剩余生产力
  4. 依次分配客流，满足低购买力客户
  5. 计算每个产品的销售杯数和销售额
- 输出数据：每个产品卖出多少杯、卖给谁（高/低购买力客户）、收入多少

#### 🔢 计算功能3：客流生成
- 每回合随机生成本回合的客流量
- 高购买力客户：建议范围10-30人
- 低购买力客户：建议范围40-80人
- **请问**：客流量的具体范围是否需要调整？

---

### 模块3：财务端（自动报表生成）

这个模块自动收集生产端和计算端的数据，生成财务报表。

#### 📊 报表内容

**支出部分（自动统计）：**
- 固定成本：
  - 租金（来自生产端）
  - 员工工资（来自生产端）
- 生产性成本：
  - 原材料采购（茶叶、牛奶、水果、配料，来自生产端）
- 临时成本：
  - 店铺装修/升级（来自生产端）
  - 市场调研（来自生产端）
  - 广告投放（来自生产端）
  - 研发费用（来自生产端）

**收入部分（自动统计）：**
- 各产品销售额（来自计算端）
- 总营业收入

**利润计算：**
- 本回合利润 = 总收入 - 总支出
- 累计利润（从第1回合开始累加）

**报表示意（请确认格式）：**
```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
             【玩家1】第3回合财务报表
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

┌─────────────────┬────────┐  ┌─────────────────┬────────┐
│  支出项目        │  金额  │  │  收入项目        │  金额  │
├─────────────────┼────────┤  ├─────────────────┼────────┤
│【固定成本】      │        │  │【营业收入】      │        │
│  租金            │  500元 │  │  奶茶销售        │  225元 │
│  员工工资        │        │  │  珍珠奶茶销售    │  500元 │
│   - 张三         │  800元 │  │                  │        │
│   - 李四         │ 1000元 │  │                  │        │
├─────────────────┼────────┤  ├─────────────────┼────────┤
│【生产性成本】    │        │  │                  │        │
│  茶叶采购        │   90元 │  │                  │        │
│  牛奶采购        │  120元 │  │                  │        │
│  水果采购        │    0元 │  │                  │        │
│  配料采购        │   36元 │  │                  │        │
├─────────────────┼────────┤  │                  │        │
│【临时成本】      │        │  │                  │        │
│  店铺装修        │    0元 │  │                  │        │
│  市场调研        │  500元 │  │                  │        │
│  广告投放        │  800元 │  │                  │        │
│  研发费用        │    0元 │  │                  │        │
├─────────────────┼────────┤  ├─────────────────┼────────┤
│ 总支出           │ 3846元 │  │ 总收入           │  725元 │
└─────────────────┴────────┘  └─────────────────┴────────┘

┌─────────────────────────────────────────────────┐
│  本回合利润：-3121元                             │
│  累计利润：  -1250元                             │
└─────────────────────────────────────────────────┘
```

---

## 🔄 三、三个模块的数据流转

我们理解的数据流转关系如下（请确认）：

```
生产端（玩家操作）
    ↓
    ├→ 租金、工资、装修费 ────────────┐
    ├→ 调研费、广告费、研发费 ────────┤
    ├→ 生产力分配、定价 ─────────────┤
    └→ 广告分 ──────────────────────┐│
                                    ││
                                    ↓↓
                              计算端（后台）
                                    │
                ┌───────────────────┼───────────────────┐
                ↓                   ↓                   ↓
          客流量生成          口碑分计算          客流分配算法
                │                   │                   │
                └───────────────────┴───────────────────┘
                                    ↓
                            销售结果（每个产品卖出杯数、销售额）
                                    │
                    ┌───────────────┴───────────────┐
                    ↓                               ↓
              生产端（更新数据）              财务端（生成报表）
                    │                               │
            累计销售杯数 ←───────────────────→  收入、支出、利润
```

---

## ✅ 四、需要您确认的问题

### 问题1：客流分配逻辑
请确认我们在"一、游戏规则理解"中的示例计算是否完全正确？特别是：
- [ ] 高购买力客户的购买顺序是否正确？
- [ ] 低购买力客户的购买顺序是否正确？
- [ ] 生产力优先满足高购买力客户的逻辑是否正确？
- [ ] "平分客户"的具体实现方式是什么？（例如：两个产品口碑分和定价都相同，各分配50%客户？）

### 问题2：定价规则
- [ ] 定价完成后是否可以调整？如果可以，多久调整一次？
- [ ] 文档中提到"每3回合可调整"，请确认是否正确？


### 问题4：客流量范围
- [ ] 每回合客流量的范围是多少？
- [ ] 是否需要设置客流量波动规律（例如前几回合少，后几回合多）？

### 问题5：游戏回合数
- [ ] 游戏总共进行多少回合？
- [ ] 每回合是否有时间限制？
回答：10回合

### 问题6：多人游戏
- [ ] 游戏支持几位玩家同时游戏？（2-6人？）
- [ ] 是否需要支持多人在线同时操作？还是单机轮流操作？
回答：2-4人

### 问题7：界面需求
- [ ] 生产端界面示意图是否符合您的预期？
- [ ] 财务报表格式是否符合您的预期？
- [ ] 是否需要数据可视化（图表展示利润趋势等）？


### 问题8：其他功能
- [ ] 是否需要保存/读取游戏进度？
- [ ] 是否需要游戏结束后的排行榜？
- [ ] 是否需要历史回合数据查询功能？

---

## 📌 下一步工作

请您审阅本文档后，告知我们：

1. ✅ **规则理解部分**是否准确无误？
2. ✅ **线上功能需求**是否完整？是否需要增减功能？
3. ✅ 上述8个问题的确认答案

确认无误后，我们将进入技术开发阶段，包括：
- 详细的技术方案设计
- 前端界面设计稿
- 数据库结构设计
- 核心算法实现
- 测试用例设计

---

**感谢您的时间！期待您的反馈。**

**项目组：前端开发团队**  
**日期：2024年**
